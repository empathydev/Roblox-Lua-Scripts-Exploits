local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:FindFirstChildOfClass("Humanoid")
local mouse = player:GetMouse()

local sword = Instance.new("Tool")
sword.Parent = player.Backpack
sword.Name = "Sword"

mouse.Button1Down:Connect(function()
    if sword.Parent == player.Backpack then
        sword.Parent = character
        sword.Grip = CFrame.new(0, 0, -1) * CFrame.Angles(math.pi/2, 0, 0)
    else
        sword.Parent = player.Backpack
    end
end)

mouse.Button2Down:Connect(function()
    local sword = character:FindFirstChild("Sword")
    if sword then
        local targetPart = mouse.Target
        if targetPart and targetPart.Parent and targetPart.Parent:FindFirstChildOfClass("Humanoid") then
            local targetHumanoid = targetPart.Parent:FindFirstChildOfClass("Humanoid")
            targetHumanoid.Health = targetHumanoid.Health - 100
        end
    end
end)

character.ChildAdded:Connect(function(child)
    if child:IsA("Tool") then
        child.Parent = player.Backpack
    end
end)

humanoid.Died:Connect(function()
    if sword.Parent == character then
        sword.Parent = player.Backpack
    end
end)

game.Players.PlayerAdded:Connect(function(player)
    if player ~= game.Players.LocalPlayer then
        player.CharacterAdded:Connect(function(character)
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            humanoid.Died:Connect(function()
                if sword.Parent == character then
                    sword.Parent = player.Backpack
                end
            end)
        end)
    end
end)
